<!DOCTYPE html>
<html lang="en">

<head>
  {% include head.html %}
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }}</title>
  <style>
    #toggle-language-btn {
      position: absolute;
      top: 70px;
      right: 110px;
      padding: 10px 10px;
      font-size: 13px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #f0f0f0;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
  </style>
</head>

<body>
  {% include tagmanager.html %}
  {% include header-episode.html %}

  <div style="position: relative;">
    <button id="toggle-language-btn" onclick="changeLanguage()">AR</button>
  </div>

  <div class="slide-menu">
    <h2>{{ site.menu_heading }}</h2>
    <ul class="post-list">
      {% assign pages = site.pages | sort: 'page_rank' %}
      {% for my_page in pages %}
        {% if (my_page.section_title != null) and my_page.type == 'stop' %}
          <li>
            <a class="post-link" href="{{ my_page.url | prepend: site.baseurl }}"
               style="background-image: url('{{ site.baseurl }}{{ site.headphones_icon_color }}');">
              <span class="post-item">{{ my_page.stop_id }}</span>
            </a>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  </div>

  <div class="page-content">
    <div class="wrapper">
      {{ content }}
    </div>
  </div>

  <div id="jp_container_1" class="jp-audio" role="application" aria-label="media player">
    <div class="jp-gui jp-interface audio-footer-container" data-role="footer" data-position="fixed" data-tap-toggle="false">
      <div class="audio-player">
        <div class="player-now-playing">
          <p id="page-title">{{ page.title }}</p>
        </div>

        {% if page.audio_file != null %}
        <div id="jquery_jplayer_1" class="jp-jplayer"></div>
        <div id="episode-element">
          <audio>
            <source id="episode-source" src="{{ site.baseurl }}{{ site.audio_path }}{{ page.audio_file }}" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>
        </div>

        <div class="jp-progress">
          <div class="jp-seek-bar">
            <div class="jp-play-bar"></div>
          </div>
        </div>

        <div class="jp-no-solution">
          <span>Update Required</span>
          To play audio, be sure to enable JavaScript, and run a browser that supports HTML5 MP3 audio, or update your 
          <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      function changeLanguage() {
        const stopId = '{{ page.stop_id }}'; // Fetch stop_id from YAML

        if (stopId === '1') {
          // Update page title
          const pageTitle = document.getElementById('page-title');
          if (pageTitle) {
            pageTitle.textContent = 'عنوان';
          }

          // Update section title
          const sectionTitle = document.querySelector('.post-header-section-title');
          if (sectionTitle) {
            sectionTitle.textContent = 'العنوان الفرعي';
          }

          // Update post content
          const postContent = document.querySelector('.post-content');
          if (postContent) {
            postContent.style.textAlign = 'right';
            postContent.style.direction = 'rtl';

            const firstParagraph = postContent.querySelector('p');
            if (firstParagraph) {
              firstParagraph.textContent = 'تم استبدال هذا النص بمحتوى جديد لتوضيح الجولة الصوتية.';
            }

            const heading = postContent.querySelector('h2');
            if (heading) {
              heading.textContent = 'المتحدث الرئيسي';
            }

            const newParagraph = document.createElement('p');
            newParagraph.textContent = 'هذا النص يشير إلى محتوى مخصص لكل محطة.';
            postContent.appendChild(newParagraph);

            console.log('Content updated for stop ID 1');
          } else {
            console.error('Post content not found');
          }
        } else {
          console.log(`No changes applied. Current stop ID: ${stopId}`);
        }
      }

      const toggleButton = document.getElementById('toggle-language-btn');
      if (toggleButton) {
        toggleButton.onclick = changeLanguage;
      } else {
        console.error('Toggle button not found');
      }
    });
  </script>

</body>
</html>
